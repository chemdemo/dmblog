{% extends 'layout.html' %}

{% block stylesheet %}
<link rel="stylesheet" href="/style/list.css" />
{% endblock %}

{% block content %}
<div class="page-body clearfix">
	<input id="csrf" type="hidden" name="_csrf" value="{{ token }}">
	<h2>{% autoescape false %}{{ page_title }}{% endautoescape %}</h2>
	{% if posts.length > 0 %}
	<ul class="ul post-list">
		{% for post in posts %}
		<li>
			<div class="box-title">
				{% if post.topped %}
				<b class="topped">【置顶】</b>
				{% endif %}
				<a class="title" href="/post/{{ post._id }}">{{ post.title }}</a>
			</div>
			<div class="box-info">
				<span class="post-date">
					<i class="icon-alarm" title="最后编辑时间"></i>
					<span class="update-date">{{ post.update_at|date('Y-m-d h:i:s') }}</span>
				</span>
				<span class="post-author">{{ post.author.name }}</span>
				<span class="post-visite">
					访问量(<span class="visite-num">{{ post.visite }}</span>) 
				</span>
				|
				<span class="post-comments">
					评论(<span class="comments-num">{{ post.comments|default(0) }}</span>)
				</span>
				{% if (user && user.admin) %}
				<a href="/edit/{{ post._id }}" class="icon-pencil post-edit" title="编辑"></a>
				<a href="javascript: void(0);" data-pid="{{ post._id }}" class="icon-trashcan post-delete" title="删除"></a>
				{% endif %}
			</div>
		</li>
		{% endfor %}
	</ul>
	{% else %}
	<section class="no-post"></section>
	{% endif %}
</div>
{% endblock %}

{% block script %}
<script data-main="/js/list.js" src="/lib/requirejs/require.js"></script>
{% endblock %}